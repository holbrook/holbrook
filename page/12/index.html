<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="baidu-site-verification" content="qnMTU0bmBQ">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  
  <link rel="stylesheet" href="/lib/animate-css/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"holbrook.github.io","root":"/","scheme":"Gemini","version":"8.0.0-rc.4","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":{"gitalk":{"order":-2}},"activeClass":"gitalk"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="心内求法">
<meta property="og:url" content="http://holbrook.github.io/page/12/index.html">
<meta property="og:site_name" content="心内求法">
<meta property="article:author" content="Holbrook">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://holbrook.github.io/page/12/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-Hans'
  };
</script>

  <title>心内求法</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?8cdb29fdf281f4429a98d7b5d0e0d4a8";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <main class="main">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader">
        <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
        <span class="toggle-line toggle-line-first"></span>
        <span class="toggle-line toggle-line-middle"></span>
        <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">心内求法</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Holbrook的个人博客</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a>

  </li>
  </ul>
</nav>




</div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Holbrook</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">125</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">68</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </section>
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </header>

      
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div id="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


      <div class="main-inner">
        

        <div class="content index posts-expand">
          
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://holbrook.github.io/2012/12/05/python_env.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Holbrook">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="心内求法">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2012/12/05/python_env.html" class="post-title-link" itemprop="url">python的环境管理</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2012-12-05 00:00:00" itemprop="dateCreated datePublished" datetime="2012-12-05T00:00:00+08:00">2012-12-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2013-06-20 00:00:00" itemprop="dateModified" datetime="2013-06-20T00:00:00+08:00">2013-06-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%BD%AF%E4%BB%B6%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">软件技术</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>用python开发软件时，由于操作系统中可能存在多个不同的python版本，并且在不同版本、不同目录下安装了各种各样的python包，导致开发环境的不一致，也会带来发布软件时运行环境的问题。通过python的包管理器pip和环境管理器virtualenv，可以很容易解决这些问题。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2012/12/05/python_env.html#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://holbrook.github.io/2012/12/05/algorithm_of_pattern_match.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Holbrook">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="心内求法">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2012/12/05/algorithm_of_pattern_match.html" class="post-title-link" itemprop="url">规则引擎中常用的模式匹配算法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2012-12-05 00:00:00" itemprop="dateCreated datePublished" datetime="2012-12-05T00:00:00+08:00">2012-12-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2018-04-16 11:04:21" itemprop="dateModified" datetime="2018-04-16T11:04:21+08:00">2018-04-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%BD%AF%E4%BB%B6%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">软件技术</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p> 规则引擎的核心是Pattern Matcher(模式匹配器)。不管是正向推理还是反向推理，首先要解决一个模式匹配的问题。</p>
<p><a href="/2012/03/20/rule_engine_1.html">前面</a>提到，规则引擎的核心是Pattern Matcher(模式匹配器)。不管是正向推理还是反向推理，首先要解决一个模式匹配的问题。</p>
<p>对于规则的模式匹配，可以定义为： 一个规则是一组模式的集合。如果事实/假设的状态符合该规则的所有模式，则称为该规则是可满足的。 模式匹配的任务就是将事实/假设的状态与规则库中的规则一一匹配，找到所有可满足的规则。</p>
<h1 id="什么是模式匹配"><a href="#什么是模式匹配" class="headerlink" title="什么是模式匹配"></a>什么是模式匹配</h1><p>对于模式匹配我们都应该不陌生，我们经常使用的正则表达式就是一种模式匹配。</p>
<ul>
<li>正则表达式是一种“模式（pattern）”</li>
<li>编程语言提供的“正则表达式引擎”就是Pattern Matcher。比如python中的re模块</li>
<li>首先输入“知识”：re.compile(r’string’)</li>
<li>然后就可以让其匹配（match）事实（字符串）</li>
<li>最后通过正则表达式引擎可以得到匹配后的结果</li>
</ul>
<p>对于规则匹配，通常定义如下：</p>
<ul>
<li>条件部分，也称为LHS(left-hand side)</li>
<li>事实部分，也称为RHS(right-hand side)</li>
</ul>
<p>假设系统中有N条规则，平均每个规则的条件部分有P个模式，在某个时点有M个事实需要处理。则规则匹配要做的事情就是： 对每一个规则r，判断当前的事实o是否满足LHS(r)=True,如果满足，则将规则r的实例r(o)，即规则+满足该规则的事实，加到冲突集中等待处理。 通常采取如下过程：</p>
<ul>
<li>从N条规则中取出一条r；</li>
<li>从M个事实中取出P个事实的一个组合c；</li>
<li>用c测试LHS(r)，如果LHS(r（c）)=True，将RHS(r（c）)加入队列中；</li>
<li>如果M个事实还存在其他的组合c，goto 3；</li>
<li>取出下一条规则r，goto 2；</li>
</ul>
<p>实际的问题可能更复杂，在规则的执行过程中可能会改变RHS的数据，从而使得已经匹配的规则实例失效或者产生新的满足规则的匹配，形成一种“动态”的匹配链。</p>
<p>上面的处理由于涉及到组合，过程很复杂。有必要通过特定的算法优化匹配的效率。目前常见的模式匹配算法包括Rete、Treat、Leaps，HAL，Matchbox等。</p>
<h1 id="Rete算法"><a href="#Rete算法" class="headerlink" title="Rete算法"></a>Rete算法</h1><p>Rete算法是目前使用最广泛的规则匹配算法，由Charles L. Forgy博士在1979年发明。Rete算法是一种快速的Forward-Chaining推理算法，其匹配速度与规则的数量无关。 Rete的高效率主要来自两个重要的假设：</p>
<ol>
<li><p>时间冗余性</p>
<p>假设facts在推理过程中的变化是缓慢的, 即在每个执行周期中,只有少数的facts发生变化，因此影响到的规则也只占很小的比例。所以可以只考虑每个执行周期中已经匹配的facts.</p>
</li>
<li><p>结构相似性</p>
<p>假设许多规则常常包含类似的模式和模式组。</p>
</li>
</ol>
<p>Rete算法的基本思想是保存过去匹配过程中留下的全部信息,以空间代价来换取执行效率 。对每一个模式 ,附加一个匹配元素表来记录WorkingMemory中所有能与之匹配的元素。当一个新元素加入到WorkingMemory时, 找出所有能与之匹配的模式, 并将该元素加入到匹配元素表中; 当一个无素从WorkingMemory中删除时,同样找出所有与该元素匹配的模式,并将元素从匹配元素表中删除。 Rete算法接受对工作存储器的修改操作描述 ,产生一个修改冲突集的动作 。</p>
<p>Rete算法的步骤如下：</p>
<ol>
<li>将初始数据（fact）输入Working Memory。</li>
<li>使用Pattern Matcher比较规则（rule）和数据（fact）。</li>
<li>如果执行规则存在冲突（conflict），即同时激活了多个规则，将冲突的规则放入冲突集合。</li>
<li>解决冲突，将激活的规则按顺序放入Agenda。</li>
<li>使用规则引擎执行Agenda中的规则。重复步骤2至5，直到执行完毕所有Agenda中的规则。</li>
</ol>
<h1 id="Tread算法"><a href="#Tread算法" class="headerlink" title="Tread算法"></a>Tread算法</h1><p>在 Rete算法中 ,同一规则连接结点上的寄存器保留了大量的冗余结果。实际上, 寄存器中大部分信息已经体现在冲突集的规则实例中。因此 ,如果在部分匹配过程中直接使用冲突集来限制模式之间的变量约束,不仅可以减少寄存器的数量 ,而且能够加快匹配处理效率 。这一思想称为 冲突集支撑策略 。</p>
<p>考虑增删事实对匹配过程的影响，当向工作存储器增加一个事实时 ,冲突集中已有的规则实例仍然保留,只是将与该事实匹配的规则实例加入到冲突集中; 当从工作存储器删去一个事实时，不可能有新的规则实例产生, 只是将 包含该事实的规则实例从冲突集中删去。</p>
<p>基于冲突集支撑策略和上述观察, Treat算法放弃了Rete算法中利用寄存器保存模式之间变量约束中间结果的思想,对于每一个模式 ,除保留原有 a寄存器的外 ,增加两个新链来记录与该模式匹配的增删事实,一个叫做增链 (addlist),另一个叫做删链 (deletelist)。当修改描述的操作符为 “+”时,临时执行部分连接任务;当修改描述的操作符为 “一”时,直接删去冲突集中包含该事实的规则实例。</p>
<p>Treat算法的步骤如下：</p>
<ol>
<li>行动 :根据点火规则的 RHS,生成修改描述表 CHANGES;</li>
<li>模式匹配:置每一模式的删链和增链为空,对 CHANGES的每一个修改描述 ,执行模式匹配。对于与修改描述中的事实匹配成功的模式,若修改描述的操作符为 “+”, 将该事实加入这一模式的增链;若修改描述的操作符为 “一”,将该事实加入这一模式的 删链。</li>
<li>删去事实的处理:对于任一模式链中的每一个事实,找到冲突集中所有包含该事实 的规则实例,并将这一规则实例从冲突集中删去。相应地修改该模式的 a寄存器 。</li>
<li>新增事实的处理:对 于 每 一 模 式 ,若 其 增 链 非 空 ,则 将 增 链 中 的 所 有 事 实 加 入 该 模 式的a寄存器 ,并对与新增事实相关的每一条规则临时执行部分匹配,寻找该规则新的实 例。具体做法为:首先将第一个模式增链中的事实集合与后一模式的 a寄存器进行连接 , 再将部分连接结果与第三个模式的a寄存器进行连接 ,一直到所有模式均连接完成为止。 其中 ,a寄存器 的内容包括新增 事实。若连接结果非空 ,则将找到 的规则 实例插入到冲突 集中。</li>
</ol>
<h1 id="Leaps-算法"><a href="#Leaps-算法" class="headerlink" title="Leaps 算法"></a>Leaps 算法</h1><p>前向推理引擎，包括LEAPS，都包括了匹配-选择-执行（match-select-action）循环。即，确定可以匹配的规则，选择某个匹配的元 组，此元组相应的规则动作被执行。重复这一过程，直到某一状态（如没有更多的规则动作）。RETE和TREAT匹配算法速度慢的原因是，它们把满足规则条 件的元组都实例化。Leaps算法的最大的改进就是使用一种”lazy”的方法来评估条件（conditions），即仅当必要时才进行元组的实例化。这 一改进极大的减少了前向推理引擎的时空复杂度，极大提高了规则执行速度。</p>
<p>Leaps算法将所有的 asserted 的 facts ，按照其被 asserted 在 Working Memory 中的顺序（ FIFO ），放在主堆栈中。它一个个的检查 facts ，通过迭代匹配 data type 的 facts 集合来找出每一个相关规则的匹配。当一个匹配的数据被发现时，系统记住此时的迭代位置以备待会的继续迭代，并且激发规则结果（ consequence ）。当结果（ consequence ）执行完成以后，系统就会继续处理处于主堆栈顶部的 fact 。如此反复。</p>
<p>Leaps算法的效率可以比Rete算法和Tread算法高几个数量级。</p>
<h1 id="其他算法"><a href="#其他算法" class="headerlink" title="其他算法"></a>其他算法</h1><p>对于HAL算法和Matchbox算法，使用的范围不是很广，这里不做过多的介绍。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://holbrook.github.io/2012/11/06/cep_about.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Holbrook">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="心内求法">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2012/11/06/cep_about.html" class="post-title-link" itemprop="url">CEP：鱼与熊掌可以兼得</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2012-11-06 00:00:00" itemprop="dateCreated datePublished" datetime="2012-11-06T00:00:00+08:00">2012-11-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2018-04-16 11:04:21" itemprop="dateModified" datetime="2018-04-16T11:04:21+08:00">2018-04-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%BD%AF%E4%BB%B6%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">软件技术</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>简单的说，事件驱动模式包括三个参与者：事件产生者，事件分发器和事件处理器。</p>
<h1 id="从事件驱动编程（Event-driven-Programming-开始"><a href="#从事件驱动编程（Event-driven-Programming-开始" class="headerlink" title="从事件驱动编程（Event-driven Programming)开始"></a>从事件驱动编程（Event-driven Programming)开始</h1><p>如果你写过GUI程序，对事件处理一定不陌生。事实上，事件驱动编程已经成为一种设计模式。大多数的GUI库都会采用这一模式。</p>
<p>简单的说，事件驱动模式包括三个参与者：事件产生者，事件分发器和事件处理器。</p>
<ul>
<li>事件产生者（Events Generator）</li>
</ul>
<p>决定是否需要产生事件。比如，GUI上的每个组件都是一个事件产生者，可以根据用户操作产生鼠标事件或者键盘事件。</p>
<ul>
<li>事件分发器（Events Dispatcher）</li>
</ul>
<p>收集所有事件产生者发出的事件放入事件队列(Events Queue)，<br>并根据事件的类型将事件分发给已经注册的事件处理器。事件分发器通常由GUI框架实现。</p>
<ul>
<li>事件处理器（Events Handler)</li>
</ul>
<p>根据接收到的事件进行处理，需要GUI框架的使用者自行编写。</p>
<p>事件驱动编程的核心价值在于：程序的执行流程不是预先定义好的，而是由程序的使用者决定的。这将极大增强程序的交互性。</p>
<p>就好像DVD与RPG游戏的区别：前者的剧情是设定好的，你只能进行开始、暂停、快进、回退等有限的交互；后者可以决定主角的行为从而影响故事的结局。</p>
<h1 id="事件驱动业务（Event-driven-Business"><a href="#事件驱动业务（Event-driven-Business" class="headerlink" title="事件驱动业务（Event-driven Business)"></a>事件驱动业务（Event-driven Business)</h1><p>代码的世界不可能是现实世界的完整镜像，但一定是对现实世界的某种抽象，这种抽象能够简化代码世界中对问题的分析和处理。<br>同时，这种抽象还可以反向映射到现实世界，为我们解决现实问题提供思路。</p>
<p>现代企业生存的外部环境处于剧烈的变化之中，“敏捷企业”已经成为生存之道，而事件驱动业务是敏捷企业的一个基本要求。</p>
<p>事件驱动业务（Event-driven Business)，是在 连续<br>的业务过程中进行决策的一种业务管理方式，即根据不同时点上出现的一系列事件触发相关的任务，并调度可用的资源执行任务。<br>如果说事件驱动编程能够为软件带来更灵活的交互性和强大的功能，那么企业中的事件驱动业务能够大幅度提高业务的效率和灵活性。</p>
<p>事件驱动业务依托于比较成熟的信息化建设。各个业务应用系统在产生连续不断的数据流的同时，根据定义好的条件产生一些“业务事件”，按照策略对这些业务事件进行分析处理，触发新的业务事件或者业务流程，即实现了业务的事件驱动。</p>
<p>从上面的描述可以看出，事件驱动业务要求能够快速（毫秒级）、不间断的处理连续、海量的数据，具备灵活的规则或策略设置，从而具备迅速识别、捕获、响应实时业务数据的能力。<br>而传统的企业IT架构通常采用：</p>
<ul>
<li>在业务应用系统中处理业务操作</li>
<li>遵循固定的业务流程（Business<br>Process）处理跨系统事务，并且这些流程很少变化</li>
<li>基于数据仓库进行海量数据的存储及事后分析</li>
</ul>
<p>这种IT架构远远达不到事件驱动业务的要求。</p>
<p>事件驱动业务能够应用的业务领域很多，凡是需要快速处理连续性数据、需要能够灵活制定策略的业务，都可以采用事件驱动的业务模式。如证券行业常见的风险分析预警（事前及事中风控）、投资决策（程序化交易）、经纪人绩效计算等。</p>
<h1 id="业务事件处理的几个层次"><a href="#业务事件处理的几个层次" class="headerlink" title="业务事件处理的几个层次"></a>业务事件处理的几个层次</h1><p>其实在传统的IT架构中，我们已经实现了业务事件的处理。比如在传统的业务应用系统中，我们通常将业务数据存储在数据库中，通过应用系统的操作界面由人工发现和处理业务事件。</p>
<p>这样的处理方式存在两个不足，一是速度慢，二是对于复杂的情况只靠人脑难以处理。于是有了两个技术方向：</p>
<ul>
<li>消息队列（MQ）<br>对于速度慢的解决办法是用机器代替人工，为了在多个系统之间传递消息，发展出了消息队列（MQ）的技术</li>
<li>商业智能（BI）<br>为了应对复杂性，通过数据仓库将数据整合到一起，并用专门的工具在数据模型的基础上进行分析</li>
</ul>
<p>但是上述两个方向是正交的：MQ不适合处理复杂性，而BI主要适应于对结构化的历史数据的分析，无法处理“现在”的情况。</p>
<h1 id="CEP：鱼与熊掌可以兼得"><a href="#CEP：鱼与熊掌可以兼得" class="headerlink" title="CEP：鱼与熊掌可以兼得"></a>CEP：鱼与熊掌可以兼得</h1><p>CEP（Complex Event<br>Processing）的出现解决了上述两个方面的问题，在实时性和复杂性方面都得到了很好的解决。</p>
<h2 id="处理数据流"><a href="#处理数据流" class="headerlink" title="处理数据流"></a>处理数据流</h2><p>不管是单独的应用系统，还是数据仓库，都是先将数据存储到数据库/数据仓库，然后再处理或查询。<br>而CEP与MQ类似的将数据看作是 数据流<br>。在连续数据的快速移动过程中进行分析处理。<br>这样的方式不需要很大的数据加载，完全可以在内存中进行，从而能够快速产生结果。</p>
<img src="/2012/11/06/cep_about/cep.png" class="" title="数据流">

<h2 id="处理复杂性"><a href="#处理复杂性" class="headerlink" title="处理复杂性"></a>处理复杂性</h2><p>业务事件可能很复杂，在各种不同的数据流中源源不断产生各种类型的事件。需要对这些业务事件进行复杂的计算，如过滤、关联、聚合等，同时还需要考虑这些也是事件出现的时间序列。<br>最终才能产生有意义的事件，或触发业务流程。同时，这些计算的规则可能还会经常变化。</p>
<p>这一类的问题通常通过基于规则的推理机（即规则引擎）来实现。</p>
<img src="/2012/11/06/cep_about/complex.png" class="" title="复杂性">

<h2 id="CEP的架构"><a href="#CEP的架构" class="headerlink" title="CEP的架构"></a>CEP的架构</h2><img src="/2012/11/06/cep_about/cep_architecture.png" class="" title="CEP的架构">

<p>综上所述，CEP在逻辑上应该包括：</p>
<ul>
<li><p>事件发生器<br>通过应用系统、文件系统、数据库、互联网、人工、以及传感器产生事件</p>
</li>
<li><p>事件处理器 模式的匹配、验证和改进，路由，转换以及编排</p>
</li>
<li><p>事件消费者<br>与事件发生器类似，也可以是应用系统、文件系统、数据库、互联网、人工界面等</p>
</li>
<li><p>小结</p>
</li>
</ul>
<p>CEP是一种比较新的企业架构(EA,Enterprise<br>Architure)组件。CEP将数据看做一种数据流，基于规则引擎对业务过程中持续产生的各种事件进行复杂的处理，能够实现对连续数据的快速分析处理。可以应用在多种业务场景，如风险分析、程序化交易等。</p>
<p>如果说BI实现了商业智能，那么CEP则实现了“持续智能（Continuous<br>Intelligence）“。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://holbrook.github.io/2012/11/06/nosql_list.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Holbrook">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="心内求法">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2012/11/06/nosql_list.html" class="post-title-link" itemprop="url">NoSQL数据库选型指引</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2012-11-06 00:00:00" itemprop="dateCreated datePublished" datetime="2012-11-06T00:00:00+08:00">2012-11-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2018-04-16 11:04:21" itemprop="dateModified" datetime="2018-04-16T11:04:21+08:00">2018-04-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%BD%AF%E4%BB%B6%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">软件技术</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <pre><code>从设计原则上，NoSQL不再强调ACID（酸），而是强调BASE（碱）。</code></pre><h1 id="什么是NoSQL"><a href="#什么是NoSQL" class="headerlink" title="什么是NoSQL"></a>什么是NoSQL</h1><p>NoSQL可以有两种解释：</p>
<ul>
<li>No SQL：“不使用SQL查询语言”。强调其轻量的特点</li>
<li>Not Only SQL：”不仅仅是查询“。强调其高性能，分布式，大容量等传统关系数据库所不具备的特性</li>
</ul>
<p>从设计原则上，NoSQL不再强调ACID（酸），而是强调BASE（碱）。</p>
<p>ACID是指：</p>
<ul>
<li>atomicity（原子性）：一个事务中的所有操作，要么全部完成，要么全部不完成。如果中途发生错误需要回滚（Rollback）</li>
<li>consistency(一致性)：在事务开始之前和事务结束以后，数据库的完整性没有被破坏。這表示寫入的資料必須完全符合所有的預設規則，這包含資料的精確度、串聯性以及後續数据库可以自發性地完成預定的工作。</li>
<li>isolation(隔離性)：当两个或者多个事务并发访问（此处访问指查询和修改的操作）数据库的同一数据时所表现出的相互关系。事务隔离分为不同级别，包括读未提交（Read uncommitted）、读提交（read committed）、可重复读（repeatable read）和串行化（Serializable）</li>
<li>durability(持久性)：在事务完成以后，该事务对数据库所作的更改便持久地保存在数据库之中，并且是完全的</li>
</ul>
<p>BASE是指：</p>
<ul>
<li>Basically Available（基本可用）</li>
<li>Soft-state（软状态/柔性事务）</li>
<li>Eventually Consistent（最终一致性）</li>
</ul>
<p>NoSQL与关系数据库的原则不同：NoSQL牺牲高一致性，换取获得可用性或可靠性。软状态意味着状态是异步的，在某些时段状态是不一致的；但最终一致保证数据早晚会一致。</p>
<h1 id="NoSQL选型要素"><a href="#NoSQL选型要素" class="headerlink" title="NoSQL选型要素"></a>NoSQL选型要素</h1><ol>
<li><p>存储结构</p>
<p>由于NoSQL的目的和原则的不同，NoSQL中的数据不是按照表存储。根据NoSQL存储结构的不同，可以分为：</p>
<ul>
<li>文档存储</li>
<li>图存储</li>
<li>key/value儲存</li>
<li>列存储</li>
<li>对象数据库</li>
</ul>
</li>
<li><p>是否持久化</p>
<p>有的NoSQL是纯内存存储，不支持持久化</p>
</li>
<li><p>是否支持嵌入式</p>
</li>
<li><p>是否支持集群部署</p>
</li>
<li><p>操作接口的丰富程度</p>
</li>
</ol>
<h1 id="常见的NoSQL数据库"><a href="#常见的NoSQL数据库" class="headerlink" title="常见的NoSQL数据库"></a>常见的NoSQL数据库</h1><ul>
<li>文档数据库</li>
</ul>
<table>
<th><td>名称</td><td>持久化</td><td>部署方式</td><td>操作接口</td><td>备注</td></th>
<tr><td>CouchDB</td><td></td><td>分布式</td><td>JavaScript MapReduce, RESTful JSON API</td><td>HTTP访问，内置了Web管理控制台</td></tr>
<tr><td>JackRabbit</td><td></td><td></td><td>Java</td><td></td></tr>
<tr><td>Lotus Notes</td><td></td><td></td><td>LotusScript, Java</td><td></td></tr>
<tr><td>BaseX</td><td></td><td></td><td></td><td>XQuery, Java</td><td></td></tr>
<tr><td>MongoDB</td><td></td><td>服务，集群</td><td>PHP，Python，Perl，Ruby，JavaScript，C++等</td><td>JSON数据库，支持全文索引，自动分片，跨LAN或WAN扩展</td></tr>
</table>

<ul>
<li>图形数据库</li>
</ul>
<table>
<th><td>名称</td><td>持久化</td><td>部署方式</td><td>操作接口</td><td>备注</td></th>
<tr><td>Neo4j</td><td></td><td></td><td>Java</td><td></td></tr>
<tr><td>DEX</td><td></td><td></td><td>Java , C#</td><td></td></tr>
<tr><td>AllegroGraph</td><td></td><td></td><td>SPARQL</td><td></td></tr>
<tr><td>FlockDB</td><td></td><td></td><td>Scala</td><td></td></tr>
</table>

<ul>
<li>key/value数据库</li>
</ul>
<table>
<th><td>名称</td><td>持久化</td><td>部署方式</td><td>操作接口</td><td>备注</td></th>
<tr><td>BigTable</td><td></td><td></td><td></td><td></td></tr>
<tr><td>memcached</td><td></td><td></td><td></td><td></td></tr>
<tr><td>Redis</td><td></td><td></td><td></td><td></td></tr>
<tr><td>Oracle Berkeley DB</td><td></td><td></td><td></td><td></td></tr>
</table>



<ul>
<li>列数据库</li>
</ul>
<table>
<th><td>名称</td><td>持久化</td><td>部署方式</td><td>操作接口</td><td>备注</td></th>
<tr><td>Cassandra</td><td></td><td></td><td></td><td></td></tr>
<tr><td>HBase</td><td></td><td></td><td></td><td></td></tr>
<tr><td>Hypertable</td><td></td><td></td><td></td><td></td></tr>
</table>

<ul>
<li>对象数据库</li>
</ul>
<table>
<th><td>名称</td><td>持久化</td><td>部署方式</td><td>操作接口</td><td>备注</td></th>
<tr><td>db4o</td><td></td><td></td><td></td><td></td></tr>
<tr><td>iBoxDB</td><td></td><td></td><td></td><td></td></tr>
<tr><td>JADE</td><td></td><td></td><td></td><td></td></tr>
<tr><td>ZODB</td><td></td><td></td><td></td><td></td></tr>
<tr><td>ObjectStore</td><td></td><td></td><td></td><td></td></tr>
</table>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://holbrook.github.io/2012/11/05/blog_design_categories_and_tags.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Holbrook">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="心内求法">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2012/11/05/blog_design_categories_and_tags.html" class="post-title-link" itemprop="url">如何规划blog的分类和标签</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2012-11-05 00:00:00" itemprop="dateCreated datePublished" datetime="2012-11-05T00:00:00+08:00">2012-11-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2018-04-16 11:04:22" itemprop="dateModified" datetime="2018-04-16T11:04:22+08:00">2018-04-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%96%B9%E6%B3%95%E5%B7%A5%E5%85%B7/" itemprop="url" rel="index"><span itemprop="name">方法工具</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>使用知识地图的思想规划博客的标签(tags)和分类(categories)</p>
<p>一篇旧的博文，原文发表在<a href="http://www.cnblogs.com/holbrook/archive/2012/11/05/2755268.html" target="_blank" rel="noopener">博客园</a>。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://holbrook.github.io/2012/11/04/knowledge_map.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Holbrook">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="心内求法">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2012/11/04/knowledge_map.html" class="post-title-link" itemprop="url">知识地图与知识管理</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2012-11-04 00:00:00" itemprop="dateCreated datePublished" datetime="2012-11-04T00:00:00+08:00">2012-11-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2013-06-10 00:00:00" itemprop="dateModified" datetime="2013-06-10T00:00:00+08:00">2013-06-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%96%B9%E6%B3%95%E5%B7%A5%E5%85%B7/" itemprop="url" rel="index"><span itemprop="name">方法工具</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>一篇旧的博文，原文发表在<a href="http://www.cnblogs.com/holbrook/archive/2012/11/04/2753533.html" target="_blank" rel="noopener">博客园</a>。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2012/11/04/knowledge_map.html#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://holbrook.github.io/2012/10/29/performance_test.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Holbrook">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="心内求法">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2012/10/29/performance_test.html" class="post-title-link" itemprop="url">QQ 餐厅与系统性能模型(续)：如何评价系统的性能</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2012-10-29 00:00:00" itemprop="dateCreated datePublished" datetime="2012-10-29T00:00:00+08:00">2012-10-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2018-04-16 11:04:21" itemprop="dateModified" datetime="2018-04-16T11:04:21+08:00">2018-04-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">软件工程</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>  作为QQ餐厅的客人，对餐厅效率的评价就是供餐“快”或者“慢”。但是对于餐厅的经营者，这样简单的考虑问题显然是不够的。</p>
<p>  在《QQ餐厅与系统性能模型》 中提到了系统性能的很多指标，而客人感觉“快”或者“慢”仅仅对应其中的 响应时间 这一指标。本文讨论如何全面评价一个系统的性能”</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2012/10/29/performance_test.html#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://holbrook.github.io/2012/10/23/whats_performance.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Holbrook">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="心内求法">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2012/10/23/whats_performance.html" class="post-title-link" itemprop="url">QQ餐厅与系统性能模型</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2012-10-23 00:00:00" itemprop="dateCreated datePublished" datetime="2012-10-23T00:00:00+08:00">2012-10-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2013-06-25 00:00:00" itemprop="dateModified" datetime="2013-06-25T00:00:00+08:00">2013-06-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">软件工程</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>本文以QQ餐厅作为模型，讨论系统性能的主要指标。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2012/10/23/whats_performance.html#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://holbrook.github.io/2012/10/16/weblayer_nginx_keepalived.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Holbrook">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="心内求法">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2012/10/16/weblayer_nginx_keepalived.html" class="post-title-link" itemprop="url">统一web访问层方案</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2012-10-16 00:00:00" itemprop="dateCreated datePublished" datetime="2012-10-16T00:00:00+08:00">2012-10-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2018-04-16 11:04:21" itemprop="dateModified" datetime="2018-04-16T11:04:21+08:00">2018-04-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%BD%AF%E4%BB%B6%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/" itemprop="url" rel="index"><span itemprop="name">软件基础设施</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>使用nginx和keepalived搭建统一的web访问层，并实现负载均衡、高可用、回话保持。这是为公司做的一个真实方案。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2012/10/16/weblayer_nginx_keepalived.html#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://holbrook.github.io/2012/04/14/fuse_develop_route.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Holbrook">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="心内求法">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2012/04/14/fuse_develop_route.html" class="post-title-link" itemprop="url">开发和部署JBoss FUSE中的路由(Route)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2012-04-14 00:00:00" itemprop="dateCreated datePublished" datetime="2012-04-14T00:00:00+08:00">2012-04-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2018-04-16 11:04:21" itemprop="dateModified" datetime="2018-04-16T11:04:21+08:00">2018-04-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%BD%AF%E4%BB%B6%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">软件技术</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="快速开始"><a href="#快速开始" class="headerlink" title="快速开始"></a>快速开始</h1><p>因为<em>Fuse的核心组成部分是ServiceMix</em>，而ServiceMix的核心组成部分是Apache<br>Camel，所以“用Fuse开发路由”也就是“开发Camel路由”。</p>
<p><a href="http://search.maven.org/#search%7Cga%7C1%7Corg.apache.camel.archetypes" target="_blank" rel="noopener">Camel提供了大量的开发</a>工具<br>，其中<a href="http://search.maven.org/#search%7Cga%7C1%7Ca%3A%22camel-archetype-blueprint%22" target="_blank" rel="noopener">camel-archetype-blueprint</a><br>是一个<a href="http://maven.apache.org/guides/introduction/introduction-to-archetypes.html" target="_blank" rel="noopener">maven<br>archetype</a>，<br>可以基于<em>Blueprint</em>，以依赖注入的方式配置CamelContext。下面快速创建一个demo:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mvn archetype:generate  \</span><br><span class="line">-DarchetypeGroupId&#x3D;org.apache.camel.archetypes \</span><br><span class="line">-DarchetypeArtifactId&#x3D;camel-archetype-blueprint \</span><br><span class="line">-DarchetypeVersion&#x3D;2.12.2 \</span><br><span class="line">-DgroupId&#x3D;thinkinside.demo.fuse \</span><br><span class="line">-DartifactId&#x3D;route-demo \</span><br><span class="line">-Dversion&#x3D;1.0.0-SNAPSHOT</span><br></pre></td></tr></table></figure>

<p>会创建如下结构的一个工程：</p>
<img src="/2012/04/14/fuse_develop_route/route-demo-structure.png" class="">

<p>从 <code>pom.xml</code><br>来看，这是一个<em>使用maven-bundle-plugin构建的OSGibundle工程</em>。</p>
<h1 id="基于Blueprint装配Camel"><a href="#基于Blueprint装配Camel" class="headerlink" title="基于Blueprint装配Camel"></a>基于<em>Blueprint</em>装配Camel</h1><p>Context</p>
<p>工程的`META-INF/blueprint/blueprint.xml’文件是一个Blueprint配置文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;blueprint xmlns&#x3D;&quot;http:&#x2F;&#x2F;www.osgi.org&#x2F;xmlns&#x2F;blueprint&#x2F;v1.0.0&quot;</span><br><span class="line">       xmlns:xsi&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2001&#x2F;XMLSchema-instance&quot;</span><br><span class="line">       xmlns:camel&#x3D;&quot;http:&#x2F;&#x2F;camel.apache.org&#x2F;schema&#x2F;blueprint&quot;</span><br><span class="line">       xsi:schemaLocation&#x3D;&quot;</span><br><span class="line">       http:&#x2F;&#x2F;www.osgi.org&#x2F;xmlns&#x2F;blueprint&#x2F;v1.0.0 http:&#x2F;&#x2F;www.osgi.org&#x2F;xmlns&#x2F;blueprint&#x2F;v1.0.0&#x2F;blueprint.xsd</span><br><span class="line">       http:&#x2F;&#x2F;camel.apache.org&#x2F;schema&#x2F;blueprint http:&#x2F;&#x2F;camel.apache.org&#x2F;schema&#x2F;blueprint&#x2F;camel-blueprint.xsd&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;bean id&#x3D;&quot;helloBean&quot; class&#x3D;&quot;thinkinside.demo.fuse.HelloBean&quot;&gt;</span><br><span class="line">      &lt;property name&#x3D;&quot;say&quot; value&#x3D;&quot;Hi from Camel&quot;&#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;bean&gt;</span><br><span class="line"></span><br><span class="line">  &lt;camelContext id&#x3D;&quot;blueprintContext&quot; trace&#x3D;&quot;false&quot; xmlns&#x3D;&quot;http:&#x2F;&#x2F;camel.apache.org&#x2F;schema&#x2F;blueprint&quot;&gt;</span><br><span class="line">    &lt;route id&#x3D;&quot;timerToLog&quot;&gt;</span><br><span class="line">      &lt;from uri&#x3D;&quot;timer:foo?period&#x3D;5000&quot;&#x2F;&gt;</span><br><span class="line">      &lt;setBody&gt;</span><br><span class="line">          &lt;method ref&#x3D;&quot;helloBean&quot; method&#x3D;&quot;hello&quot;&#x2F;&gt;</span><br><span class="line">      &lt;&#x2F;setBody&gt;</span><br><span class="line">      &lt;log message&#x3D;&quot;The message contains$&#123;body&#125;&quot;&#x2F;&gt;</span><br><span class="line">      &lt;to uri&#x3D;&quot;mock:result&quot;&#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;route&gt;</span><br><span class="line">  &lt;&#x2F;camelContext&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;blueprint&gt;</span><br></pre></td></tr></table></figure>

<p>该配置文件中，定义了一个id为 <code>blueprintContext</code> 的Camel<br>Context。这个Context中定义了一个路由：</p>
<ol>
<li>入口为一个Timer类型的Endpoint</li>
<li>使用预定义的bean为Message设置body</li>
<li>记录日志</li>
<li>出口为一个Mock类型的Endpoint</li>
</ol>
<p>如果使用FuseIDE，可以看到图形化的配置界面：</p>
<img src="/2012/04/14/fuse_develop_route/route-design.png" class="">

<h1 id="部署到ServiceMix"><a href="#部署到ServiceMix" class="headerlink" title="部署到ServiceMix"></a>部署到ServiceMix</h1><p>执行 <code>mvn package</code> 后，得到 <code>route-demo-1.0.0-SNAPSHOT.jar</code><br>，这是一个OSGi bundle。可以将jar文件部署到</p>
<p>=$SERVICEMIX<del>HOME</del>/deploy/=<br>目录中。正常情况下，bundle的依赖关系被满足，该bundle会被自动启动。</p>
<h1 id="从ServiceMix到Fuse"><a href="#从ServiceMix到Fuse" class="headerlink" title="从ServiceMix到Fuse"></a>从ServiceMix到Fuse</h1><p>上述的过程也适用于JBoss Fuse。</p>
<p>但是Fuse对ServiceMix进行了再次封装，需要使用Fuse对应的版本。比如，=camel-archetype-blueprint=<br>的版本可能要使用 <code>2.10.0.redhat-60024</code><br>这样的“Fuse版本号”，否则在部署到Fuse是可能会发生版本不匹配的问题。</p>
<p>Fuse提供了一个maven仓库，专门提供这种定制版本的组件，需要在maven中配置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;repository&gt;</span><br><span class="line">    &lt;id&gt;fusesource&lt;&#x2F;id&gt;</span><br><span class="line">    &lt;url&gt;http:&#x2F;&#x2F;repo.fusesource.com&#x2F;nexus&#x2F;content&#x2F;groups&#x2F;public&#x2F;&lt;&#x2F;url&gt;</span><br><span class="line">    &lt;snapshots&gt;</span><br><span class="line">        &lt;enabled&gt;false&lt;&#x2F;enabled&gt;</span><br><span class="line">    &lt;&#x2F;snapshots&gt;</span><br><span class="line">    &lt;releases&gt;</span><br><span class="line">         &lt;enabled&gt;true&lt;&#x2F;enabled&gt;</span><br><span class="line">     &lt;&#x2F;releases&gt;</span><br><span class="line">&lt;&#x2F;repository&gt;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/11/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><span class="page-number current">12</span><a class="page-number" href="/page/13/">13</a><a class="extend next" rel="next" href="/page/13/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



        </div>
        

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Holbrook</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/next-boot.js"></script>


  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>















  

  


</body>
</html>
